<!DOCTYPE html>
<html>
<!-- Viewport för att göra så att man inte kan zooma på mobil enhet -->
<meta name="viewport" content="initial-scale=1.0" />
 <meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="main.css">
<head>
	<title>Atlas</title>
</head>
<script src="http://d3lp1msu2r81bx.cloudfront.net/kjs/js/lib/kinetic-v4.7.4.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
	<body>
		<div class="container">		
			<!--<div class="navbar"> <p>Frågor</p></div>
			<div class="quiz"><p>Bilder</p></div>-->
			<div id="canvas"></div>
			<!--<div class="help"><p>Nånting</p></div>-->
			 <script defer="defer">

			        //Skapar stagen
			        //Container: Bestämmer vart canvasen ska lägga sig
			        //Width: Storlek på stagen
			        //Height: Höjd på stagen        		       
			        var stage = new Kinetic.Stage({
			          container: "canvas",
			          width:  window.innerWidth,
			          height: window.innerHeight
			        });

			        //Skapar ett lager till stagen
			        var layer = new Kinetic.Layer();

			        //Bakgrundslagret där bakgrundsbilden ligger
			        var background_layer = new Kinetic.Layer();

			        //Lägger till lagret i stagen
			        stage.add(background_layer);
			        stage.add(layer);
			        
			       
			        //Ändrar storleken på stagen. Verkar inte funka om jag tar bort detta, oklart varför..
			        var h2 = $(".kineticjs-content").height()
			        var w2 = $(".kineticjs-content").width()
			        stage.setWidth(w2)
			        stage.setHeight(h2)

			        
			        //Skapar cirkelobjektet 
			        //x: bestämmer startposition i x
			        //y: bestämmer startposition i y
			        //Radius: bestämmer radien
			        //Fill: bestämmer innerfärgen
			        //Stroke: bestämmer randfärgen
			        //Strokewidth: randstorlek
			        //draggable: true/false
			        //dragbounds: Vart man får dra den
			        var circle = new Kinetic.Circle({
			        	x: stage.getWidth() /2,
			        	y: stage.getHeight() /2,
			        	radius: 5,
			        	fill: 'red',
			        	stroke: 'black',
			        	strokeWidth: 4,
			        	draggable: true,
			        	dragbounds: {
			        		left: stage.getWidth(), right: stage.getHeight()
			        	}
			        });
			      	
			      	//För att kunna räkna ut var en punkt bör hamna på alla skärmar utgår jag från min skärm (UX32VD/Carl)
			      	//window.innerWidth/Height är storleken på webbfönstret hos den lokala användaren. Detta delar en med 
			      	//storleken på fönstret från UX32VD (1920 i bredd och 979 i höjd). Sedan multiplicerar man med punkten.
			        var circle2 = new Kinetic.Circle({
			        	 x: ((window.innerWidth)/1920)*1108.6,
			        	 y: ((window.innerHeight)/979)*351.6,
			             radius: 1,
			             fill: 'red',
			             stroke: 'black',
			             strokeWidth: 4,
			             dragbounds: {
			        		left: stage.getWidth(), right: stage.getHeight(),
			            }
			        });


			        //Skapar en linje, denna ritas sedan i dragend funktionen längre ner
			        var line = new Kinetic.Line({ 
			            stroke: 'red',
					    strokeWidth: 1,
					});

			        //Skapar ett imageobjekt, i detta fall Yoda
			        var imageObj = new Image();
			        imageObj.onload = function() {
				        var yoda = new Kinetic.Image({
				          x: stage.getWidth() /4,
				          y: stage.getWidth() /4,
				          image: imageObj,
				          width: 106,
				          height: 118,
				         
				    });


				   //Textobjekt.  Detta bör man kunna hämta via en databas
				   var simpleText = new Kinetic.Text({
					      x: (window.innerHeight/100)*20,
					      y: (window.innerHeight/100)*90,
					      text: 'Vart ligger Rysslands huvudstad?',
				          fontSize: 30,
				          fontFamily: 'Calibri',
			    	      fill: 'black'
					       
					});


				   //Textobjekt. Detta bör man kunna hämta via en databas
				   var simpleText2 = new Kinetic.Text({
			              x: (window.innerHeight/100)*20,
					      y: (window.innerHeight/100)*95,
					      text: 'Svaret var Moskva',
				          fontSize: 30,
				          fontFamily: 'Calibri',
			    	      fill: 'black'
					       
				   });

				   //Rektangelobjekt
			      var rect = new Kinetic.Rect({
				         x: stage.getWidth() /3,
				         y: stage.getHeight() /4,
				         width: 600,
				         height: 400,
				         fill: 'white',
				         stroke: 'black',
				         strokeWidth: 4
			      });

			      //Rektangelobjekt
			      var rect2 = new Kinetic.Rect({
				         x: (window.innerHeight/100)*20,
				         y: (window.innerHeight/100)*90,
				         width: (window.innerHeight),
				         height: h2/10,
				         fill: 'white',
				         stroke: 'black',
				         strokeWidth: 4,
			       
			      });


			      //Detta är nödvändigt för att få punkten på samma ställe över alla plattformar
			      //Man sätter skalningen på bakgrunden genom width och height, denna sätts alltid
			      //till fönsterstorleken på det aktuella fönstret. Då kan man få ut en skala som
			      //stämmer överens genom alla plattformar.
			      var canvasBackgroundImage = new Image();
				  canvasBackgroundImage.onload = function() {
				      var backgroundImage = new Kinetic.Image({
			            x: 0,
			            y: 0,
			            image: canvasBackgroundImage,
			            width: window.innerWidth,
			            height: window.innerHeight,
			            opacity: 1.0
				        });
				        background_layer.add(backgroundImage);
        				background_layer.draw();
				        
				    };
				    canvasBackgroundImage.src = ('http://www.carlenglund.se/atlas/lol.png'); //Location of our background
			       
			     //Kollar position när man slutar dra
			     //Skriver ut positionen i x/y-led
			     //Sätter punkterna linjen ska gå emellan
			     //lägger till linjen och cirkeln till lagret och ritar om
			     	circle.on('dragend', function() {  
				        circle.setDraggable(false)

				  		line.setPoints([circle2.getPosition().x, circle2.getPosition().y, circle.getPosition().x, circle.getPosition().y]);
				  		layer.add(line);
				        layer.add(circle2);
				        yoda.remove();
				        //layer.add(rect);
				        layer.add(simpleText2)

				        

				        circle.setFill('green');
				        layer.draw();
			        
			        //setInterval(function(){window.location="http://www.carlenglund.se/atlas"},2000);

     				 });

			     //Lägger till cirkeln till lagret och sedan lägger lagret i stagen
			   	  //layer.add(rect);
			      layer.add(rect2);
			      layer.add(simpleText);
			      layer.add(yoda);
			      layer.add(circle);
			      
			      stage.add(layer);
			 
			        
				 }; imageObj.src = 'http://www.html5canvastutorials.com/demos/assets/yoda.jpg';

			    </script>
			
		</div>


	</body>
</html>




